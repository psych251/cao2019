bxp_eval_plot <- ggplot(bxp_eval,
aes(x = target, y = value, fill = target)) +
geom_boxplot() +
geom_jitter(width = 0.2)
bxp_eval_plot
##Target vs posterior percent vs composite.avg scatterplot
data_clean %>%
ggplot(mapping = aes(x = composite.avg, y = posterior_percent, color = target)) +
geom_point() +
geom_smooth() +
scale_x_continuous(breaks = seq(1, 7, 1)) +
scale_y_continuous(breaks = seq(0, 1, 0.10),
label = percent_format())
skewness(bar_2$value, na.rm = TRUE) #coeff is -0.03
bar_2 %>%
group_by(target, type) %>%
identify_outliers(value) #single non=extreme outlier
bar_2 %>%
group_by(target, type) %>%
shapiro_test(value)
bar_2
bar_2 %>%
group_by(target, type) %>%
shapiro_test(value)
bar_2
bar_2 %>%
group_by (target) %>%
levene_test(value ~ type) #non=homogeneity of variance in woman condition (0.02 p-value)
# check mean posterior percent
data_clean %>%
group_by(target) %>%
summarize(mean = mean(posterior_percent)) #still higher for man than woman. But woman didnt move much
bar <- data_clean %>%
select(prior_percent, posterior_percent, target)
bar <- bar %>%
pivot_longer(-c("target"),
names_to = "type",
values_to = "value")
bar <- bar %>%
mutate_at(vars(type), factor) #
stderror <- function(x) sd(x)/sqrt(length(x))
bar <- bar %>%
mutate(SE = stderror(value)) # SE = 0.0382
dodge <- position_dodge(width = 0.5)
bar$type <- factor(bar$type, levels = c("prior_percent", "posterior_percent"))
bar_summ <- bar %>%
group_by(target, type) %>%
summarize(mean = mean(value),
SE = stderror(value))
barplot_1 <- ggplot(bar_summ,
aes(x = target, y = mean, fill = type)) +
geom_bar(width = 0.7, position= position_dodge(width = 0.75), stat = "identity", ) +
labs (y = expression(paste(italic(P), "(Target = Pilot)"))) +
scale_y_continuous(breaks = seq(0, 1, 0.10),
label = percent_format()) +
geom_errorbar(aes(ymax = mean + SE, ymin = mean - SE), position = position_dodge(0.75), width = 0.2) +
scale_fill_discrete(labels = c("prior",
"posterior")) +
theme(legend.title = element_blank()) +
theme(legend.position = c(0.25, 0.2)) +
theme(legend.justification = c(0.25, 0.2)) +
theme(legend.direction = "vertical")
barplot_1
# lets visualize - focus on the distribution of posterior women
bxp_1 <- ggplot(bar,
aes(x = target, y = value,  fill = type)) +
geom_boxplot() +
theme(legend.title = element_blank()) +
theme(legend.position = c(0.25, 0.2)) +
theme(legend.justification = c(0.25, 0.2)) +
theme(legend.direction = "vertical")
bxp_1
barplot_1
bxp_1
![Figure 4 for comparison](/figure4)
getwd()
# will be linear ANVOVA of posterior percent vs person X attributions
figure4 <- data_clean %>%
ggplot(mapping = aes(x = composite.avg, y = posterior_percent, color = target)) +
geom_smooth(method = "lm", se = TRUE) +
theme_classic() +
scale_x_continuous(breaks = seq(1, 7, 1)) +
scale_y_continuous(breaks = seq(0, 1, 0.10),
label = percent_format()) +
theme(aspect.ratio = 10/7) +
scale_color_discrete(labels = c("Man communicated w/ATC",
"Woman communicated w/ATC")) +
annotate("text", c(1.5, 5.7), y = -0.15,
label = c("Negative", "Positive")) +
annotate("text", c(3.5), y = -0.2 , label = c("Evaluation of Person X")) +
coord_cartesian(xlim = c(1, 6), ylim = c(0, 1), clip = "off") +
labs ( y = expression(paste(italic(P), "(Target = Pilot)"))) +
theme(plot.margin = unit(c(1, 1, 4, 1), "lines"),
axis.title.x = element_blank(),
text=element_text(size=12,  family="sans")
)
figure4
knitr::include_graphics('/Users/JosephOuta/Desktop/GitHub/images/figure.png')
library(tidyverse) # for data munging
library(knitr)
library(rstatix)
library(ggpubr)
getwd()
d <- read_csv("Desktop/GitHub/AgencyProj/agendata.csv")
library(tidyverse) # for data munging
library(knitr)
library(rstatix)
library(ggpubr)
getwd()
d <- read_csv("Desktop/GitHub/AgencyProj/agendata.csv")
length(d_excl3$ResponseId) # 180 rows left
library(tidyverse) # for data munging
library(knitr)
library(rstatix)
library(ggpubr)
getwd()
d <- read_csv("Desktop/GitHub/AgencyProj/agendata.csv")
library(tidyverse) # for data munging
library(knitr)
library(rstatix)
library(ggpubr)
getwd()
d <- read_csv("Desktop/GitHub/AgencyProj/agendata.csv")
getwd()
d <- read_csv("Desktop/GitHub/AgencyProj/agendata.csv")
getwd()
getwd()
getwd()
d <- read_csv("Desktop/GitHub/AgencyProj/agendata.csv")
knitr::opts_knit$set(root.dir = '/tmp')
getwd()
setwd("Users/JosephOuta/Desktop/GitHub/AgencyProj/")
getwd()
knitr::opts_knit$set(root.dir = 'Users/JosephOuta/Desktop/GitHub/AgencyProj/')
getwd()
d <- read_csv("agendata.csv")
knitr::opts_knit$set(root.dir = 'Users/JosephOuta/Desktop/GitHub/AgencyProj/')
library(tidyverse) # for data munging
library(knitr)
library(rstatix)
library(ggpubr)
getwd()
d <- read_csv("agendata.csv")
head(d)
colnames(d)
#Removing irrelevant column titles
rowlength <- length(d$ResponseId) # = 251 rows
d_notitles <- d[3:rowlength,] #remove first 2 rows with title info
d_noprev <- filter(d_notitles, Status==0) #Removing Survey Preview rows
d_cond <- arrange(d_noprev, Agency2) #Arrange data by condition
#what's Q51?
select(d, Q51) #looks like its the end checks for the non agency condition
#rename columns
colnames(d_cond)
names(d_cond)[86] <- "ECNA" # rename column Q51 to ECNA
names(d_cond)[91] <- "AttnCheck" #rename "debrief+attend" to attention check
# exclude columns with demographic info -> for analysis
d_tidy <- select(d_cond, ResponseId, 23:86,91)
length(d_tidy$ResponseId) #241 participants
select(d_tidy, AttnCheck) #view attention check column
d_excl1 <- filter(d_tidy, AttnCheck==5) #exclude if didn't answer yes (option 5)
Attncheck2_excl_total <- length(d_tidy$ResponseId) - length(d_excl1$ResponseId) #9 exclusions
d_excl2 <- filter(d_excl1, !grepl("5", Agency2),
# CODER 1 - JOSEPH OUTA
!grepl("Balancing the Company's Needs and Employee Satisfaction", Agency2), #page 1
!grepl("Based on the company values or mission statement", Agency2),
!grepl("By the value", Agency2),
!grepl("Company decisions should be based on values", Agency2),
!grepl("Decisions will be all over the place and inconsistent.", Agency2),
!grepl("Employees should make decisions based on values.", Agency2), #page 2 of preview
!grepl("Employees should keep the big picture in mind. Not ever customer will be the same and they must respect them and handle them in a friendly manner.", Agency2), # page 3
!grepl("Focus on customer care and well-being", Agency2), # page 4
!grepl("It treats the costumer with professionalism", Agency2),
!grepl("Quality and respect", Agency2), #page 5
!grepl("quickly and confidently", Agency2),
!grepl("should make them respectfully and fairly", Agency2), #page 7
!grepl("That they should do them with the best interests of the company in mind", Agency2),
!grepl("They respect there policy", Agency2), #page 8
!grepl("They should make decisions that the company would approve of and they themselves would approve of.", Agency2),
!grepl("They should think about your value as a pets", Agency2), #page 9
!grepl("They should try to be more friendly towards customers.", Agency2),
!grepl("to serve the customer best", Agency2), #page 10
!grepl("Treat customers in professional and friendly manner", Agency2),
!grepl("treat employees well", Agency2),
!grepl("Treat the customers well.", Agency2),
!grepl("yes", Agency2), #page 11
## CODER 2 - YUEL LI ADDITIONAL EXCLUSIONS
!grepl("Allows customers to make company decisions", Agency2),
!grepl("By working together", Agency2),
!grepl("Employees of SerVest should be mindful of the different value's their customers might have.", Agency2),
!grepl("Employees should make company decisions based on the values the company at large has, not their own.", Agency2),
!grepl("Employees should make company decisions taking into account customer values.", Agency2),
!grepl("Employees should make company decisions with the customer's best interest in mind. All decisions should benefit the customer first.", Agency2),
!grepl("employees should make the best decisions for the customers", Agency2),
!grepl("Employees should work together to make decisions.", Agency2),
!grepl("Following their guidelines", Agency2),
!grepl("How to best serve their interests.", Agency2),
!grepl("I believe that when the company encourages people who do not agree with their beliefs to find another place to be serviced, it gives the employees more power to say who can and cannot shop there.", Agency2),
!grepl("In a professional and caring manner", Agency2),
!grepl("Sarvest trusts its employees to make good decisions", Agency2),
!grepl("Servest relies on employees making good choices.", Agency2),
!grepl("SerVest understands that company values vary and they trust companies to make their own decisions that reflect those.", Agency2),
!grepl("That the company has certain values and also employees should also have those values and their own", Agency2),
!grepl("They respect there policy", Agency2),
!grepl("They should accomidate the customer's values", Agency2),
!grepl("They should make decisions that the company would approve of and they themselves would approve of.", Agency2),
!grepl("They should make decisions with the customers in mind", Agency2),
!grepl("They should put customer service first.", Agency2),
!grepl("They should reflect customer values", Agency2),
!grepl("they take in mind what customers say", Agency2),
!grepl("to reflect customer's beliefs", Agency2),
!grepl("trust employee to make decisions that will reflect positively on the company", Agency2),
!grepl("values reflect the work culture", Agency2),
!grepl("with consideration of the customer needs", Agency2),
!grepl("With morals & sincerity. SerVest trusts the employees", Agency2),
!grepl("with the customer in mind", Agency2),
!grepl("with the upmost integrity", Agency2)
)
length(d_excl2$ResponseId) # 210 rows left
# How many exclusions?
Agency_excl_total <- length(d_excl1$ResponseId) - length(d_excl2$ResponseId) #22 participants
d_excl3 <- d_excl2 %>%
filter(!grepl("By keeping a good relationship with the customer- honesty and respect.", NonA2), #page 1
!grepl("Company decisions are basically based in how they treat their cliental.", NonA2),
!grepl("Decisions should be made in a way that will serve the customers better", NonA2),
!grepl("Do not understand the question", NonA2),
!grepl("Employees should share their knowledge with others", NonA2),# page 3
!grepl("employess should be involved with company decisions since everyone has different opinions", NonA2), #page 4
!grepl("Ethical decisions", NonA2),
!grepl("I cannot remember", NonA2),
!grepl("im not aware", NonA2),
!grepl("It denotes professionalism that isn't swayed by the person in charge's own views.", NonA2),
!grepl("It says that Servest understands there are different personal values and trusts that those values will be reflected by you in the company.", NonA2),
!grepl("iT SHOULD BE REAL", NonA2), #page 5
!grepl("make them as a good decision", NonA2),
!grepl("my values might clash with company values", NonA2),
!grepl("Of course, they should think carefully and make a good decision", NonA2), #page 7
!grepl("Of course, they should think carefully and make a good decision.", NonA2),
!grepl("ok", NonA2),
!grepl("SerVest does not discriminate.", NonA2), #page 8
!grepl("should keep customer in mind", NonA2),
!grepl("Should not use company's beliefs as part of personality", NonA2),
!grepl("They are respectful and pay close attention to detail", NonA2), #page 9
!grepl("they say you put the emotions of the customer into consideration", NonA2),
!grepl("They should think about the customer more than themselves.", NonA2),#page 10
!grepl("to the best", NonA2), #page 11
!grepl("Trust themselves to not let their values be swayed", NonA2),
!grepl("Value your privacy and your opinions.", NonA2),
!grepl("varies", NonA2),
!grepl("Vary depending on customer values", NonA2), #page 12
!grepl("with responsibility", NonA2),
!grepl("You should decide what to do", NonA2),
# CODER 2 - YUE LI ADDITIONAL EXCLUSIONS
!grepl("Employees Should be able to make their own decisions", Agency2),
!grepl("information technogy company", Agency2),
!grepl("It's Information Technogy", Agency2),
!grepl("Like many companies, SerVest is committed to making sure customers are treated in a professional, friendly, and patient manner.", Agency2),
!grepl("my values might conflict with the company's", Agency2)
)
length(d_excl3$ResponseId) # 180 rows left
# How many exclusions?
NonAgency_excl_total <- length(d_excl2$ResponseId) - length(d_excl3$ResponseId) #30 exclusions
knitr::opts_knit$set(root.dir = 'Users/JosephOuta/Desktop/GitHub/AgencyProj/')
library(tidyverse) # for data munging
library(knitr)
library(rstatix)
library(ggpubr)
getwd()
d <- read_csv("agendata.csv")
head(d)
colnames(d)
#Removing irrelevant column titles
rowlength <- length(d$ResponseId) # = 251 rows
d_notitles <- d[3:rowlength,] #remove first 2 rows with title info
d_noprev <- filter(d_notitles, Status==0) #Removing Survey Preview rows
d_cond <- arrange(d_noprev, Agency2) #Arrange data by condition
#what's Q51?
select(d, Q51) #looks like its the end checks for the non agency condition
#rename columns
colnames(d_cond)
names(d_cond)[86] <- "ECNA" # rename column Q51 to ECNA
names(d_cond)[91] <- "AttnCheck" #rename "debrief+attend" to attention check
# exclude columns with demographic info -> for analysis
d_tidy <- select(d_cond, ResponseId, 23:86,91)
length(d_tidy$ResponseId) #241 participants
select(d_tidy, AttnCheck) #view attention check column
d_excl1 <- filter(d_tidy, AttnCheck==5) #exclude if didn't answer yes (option 5)
Attncheck2_excl_total <- length(d_tidy$ResponseId) - length(d_excl1$ResponseId) #9 exclusions
d_excl2 <- filter(d_excl1, !grepl("5", Agency2),
# CODER 1 - JOSEPH OUTA
!grepl("Balancing the Company's Needs and Employee Satisfaction", Agency2), #page 1
!grepl("Based on the company values or mission statement", Agency2),
!grepl("By the value", Agency2),
!grepl("Company decisions should be based on values", Agency2),
!grepl("Decisions will be all over the place and inconsistent.", Agency2),
!grepl("Employees should make decisions based on values.", Agency2), #page 2 of preview
!grepl("Employees should keep the big picture in mind. Not ever customer will be the same and they must respect them and handle them in a friendly manner.", Agency2), # page 3
!grepl("Focus on customer care and well-being", Agency2), # page 4
!grepl("It treats the costumer with professionalism", Agency2),
!grepl("Quality and respect", Agency2), #page 5
!grepl("quickly and confidently", Agency2),
!grepl("should make them respectfully and fairly", Agency2), #page 7
!grepl("That they should do them with the best interests of the company in mind", Agency2),
!grepl("They respect there policy", Agency2), #page 8
!grepl("They should make decisions that the company would approve of and they themselves would approve of.", Agency2),
!grepl("They should think about your value as a pets", Agency2), #page 9
!grepl("They should try to be more friendly towards customers.", Agency2),
!grepl("to serve the customer best", Agency2), #page 10
!grepl("Treat customers in professional and friendly manner", Agency2),
!grepl("treat employees well", Agency2),
!grepl("Treat the customers well.", Agency2),
!grepl("yes", Agency2), #page 11
## CODER 2 - YUEL LI ADDITIONAL EXCLUSIONS
!grepl("Allows customers to make company decisions", Agency2),
!grepl("By working together", Agency2),
!grepl("Employees of SerVest should be mindful of the different value's their customers might have.", Agency2),
!grepl("Employees should make company decisions based on the values the company at large has, not their own.", Agency2),
!grepl("Employees should make company decisions taking into account customer values.", Agency2),
!grepl("Employees should make company decisions with the customer's best interest in mind. All decisions should benefit the customer first.", Agency2),
!grepl("employees should make the best decisions for the customers", Agency2),
!grepl("Employees should work together to make decisions.", Agency2),
!grepl("Following their guidelines", Agency2),
!grepl("How to best serve their interests.", Agency2),
!grepl("I believe that when the company encourages people who do not agree with their beliefs to find another place to be serviced, it gives the employees more power to say who can and cannot shop there.", Agency2),
!grepl("In a professional and caring manner", Agency2),
!grepl("Sarvest trusts its employees to make good decisions", Agency2),
!grepl("Servest relies on employees making good choices.", Agency2),
!grepl("SerVest understands that company values vary and they trust companies to make their own decisions that reflect those.", Agency2),
!grepl("That the company has certain values and also employees should also have those values and their own", Agency2),
!grepl("They respect there policy", Agency2),
!grepl("They should accomidate the customer's values", Agency2),
!grepl("They should make decisions that the company would approve of and they themselves would approve of.", Agency2),
!grepl("They should make decisions with the customers in mind", Agency2),
!grepl("They should put customer service first.", Agency2),
!grepl("They should reflect customer values", Agency2),
!grepl("they take in mind what customers say", Agency2),
!grepl("to reflect customer's beliefs", Agency2),
!grepl("trust employee to make decisions that will reflect positively on the company", Agency2),
!grepl("values reflect the work culture", Agency2),
!grepl("with consideration of the customer needs", Agency2),
!grepl("With morals & sincerity. SerVest trusts the employees", Agency2),
!grepl("with the customer in mind", Agency2),
!grepl("with the upmost integrity", Agency2)
)
length(d_excl2$ResponseId) # 210 rows left
# How many exclusions?
Agency_excl_total <- length(d_excl1$ResponseId) - length(d_excl2$ResponseId) #22 participants
d_excl3 <- d_excl2 %>%
filter(!grepl("By keeping a good relationship with the customer- honesty and respect.", NonA2), #page 1
!grepl("Company decisions are basically based in how they treat their cliental.", NonA2),
!grepl("Decisions should be made in a way that will serve the customers better", NonA2),
!grepl("Do not understand the question", NonA2),
!grepl("Employees should share their knowledge with others", NonA2),# page 3
!grepl("employess should be involved with company decisions since everyone has different opinions", NonA2), #page 4
!grepl("Ethical decisions", NonA2),
!grepl("I cannot remember", NonA2),
!grepl("im not aware", NonA2),
!grepl("It denotes professionalism that isn't swayed by the person in charge's own views.", NonA2),
!grepl("It says that Servest understands there are different personal values and trusts that those values will be reflected by you in the company.", NonA2),
!grepl("iT SHOULD BE REAL", NonA2), #page 5
!grepl("make them as a good decision", NonA2),
!grepl("my values might clash with company values", NonA2),
!grepl("Of course, they should think carefully and make a good decision", NonA2), #page 7
!grepl("Of course, they should think carefully and make a good decision.", NonA2),
!grepl("ok", NonA2),
!grepl("SerVest does not discriminate.", NonA2), #page 8
!grepl("should keep customer in mind", NonA2),
!grepl("Should not use company's beliefs as part of personality", NonA2),
!grepl("They are respectful and pay close attention to detail", NonA2), #page 9
!grepl("they say you put the emotions of the customer into consideration", NonA2),
!grepl("They should think about the customer more than themselves.", NonA2),#page 10
!grepl("to the best", NonA2), #page 11
!grepl("Trust themselves to not let their values be swayed", NonA2),
!grepl("Value your privacy and your opinions.", NonA2),
!grepl("varies", NonA2),
!grepl("Vary depending on customer values", NonA2), #page 12
!grepl("with responsibility", NonA2),
!grepl("You should decide what to do", NonA2),
# CODER 2 - YUE LI ADDITIONAL EXCLUSIONS
!grepl("Employees Should be able to make their own decisions", Agency2),
!grepl("information technogy company", Agency2),
!grepl("It's Information Technogy", Agency2),
!grepl("Like many companies, SerVest is committed to making sure customers are treated in a professional, friendly, and patient manner.", Agency2),
!grepl("my values might conflict with the company's", Agency2)
)
length(d_excl3$ResponseId) # 180 rows left
# How many exclusions?
NonAgency_excl_total <- length(d_excl2$ResponseId) - length(d_excl3$ResponseId) #30 exclusions
#first check who left blank
d_filtertest_3 <- d_excl3 %>%
filter(is.na(Agency2)) %>% #check what rows are NA in Agency...
filter(is.na(NonA2)) #...that are also NA in Non Agency
d_filtertest_3 #these are 6 participants in total
#then exclude them
d_excl4 <- filter(d_excl3, !grepl("R_RP0Xu1ld7b9k4PT", ResponseId),#exclude the 6 participants
!grepl("R_2uyeCzCvlfF65O1", ResponseId),
!grepl("R_UzNZ8VgoKNfq3Zv", ResponseId),
!grepl("R_3ixmIniTJQMh1T0", ResponseId),
!grepl("R_24BFpyvSimlCdnS", ResponseId),
)
d_excl4 # 175 rows
# How many exclusions?
Blanks_excl_total <- length(d_excl3$ResponseId) - length(d_excl4$ResponseId) # 5 exclusions
#Total attention check exclusions
Total_attn_excls <- Attncheck2_excl_total + Agency_excl_total + NonAgency_excl_total + Blanks_excl_total
Total_attn_excls #66 excluded
#participants in each condition
length(d_tidy$ResponseId) #pre-exclusion and preview-removal length = 241
length(d_excl4$ResponseId) #post-exclusion length = 175
A <- filter(d_excl4, !is.na(Agency2))
length(A$ResponseId) #88 in Agency condition
NonA <- filter(d_excl4, !is.na(NonA2))
length(NonA$ResponseId) #87 in Non-Agency condition
colnames(d_excl4)
str(d_excl4)
dat <- d_excl4
#condition1
dat[3:33] <- sapply(X = dat[3:33],
FUN = as.numeric)
#condition2
dat[35:66] <- sapply(X = dat[35:66],
FUN = as.numeric)
str(dat)
# AGENCY CONDITION - total deserve behaviors ## ==================================================== ##
# Sabotage1
dat <- dat %>%
rowwise() %>%
mutate(deserve.sab1 = sum(Sab1_1, Sab1_2, Sab1_3, Sab1_4, Sab1_5, na.rm = TRUE))
range(dat$deserve.sab1) #confirm response totals are within 0-5 range
# Sabotage2
dat <- dat %>%
rowwise() %>%
mutate(deserve.sab2 = sum(Sab2_1, Sab2_2, Sab2_3, Sab2_4, Sab2_5, na.rm = TRUE))
# Sabotage3
dat <- dat %>%
rowwise() %>%
mutate(deserve.sab3 = sum(Sab3_1, Sab3_2, Sab3_3, Sab3_4, Sab3_5, na.rm = TRUE))
# AGENCY CONDITION - total actual behaviors ## ==================================================== ##
# Sabotage1
dat <- dat %>%
rowwise() %>%
mutate(actual.sab1 = sum(Sab1b_1, Sab1b_2, Sab1b_3, Sab1b_4, Sab1b_5, na.rm = TRUE))
# Sabotage2
dat <- dat %>%
rowwise() %>%
mutate(actual.sab2 = sum(Sab2b_1, Sab2b_2, Sab2b_3, Sab2b_4, Sab2b_5, na.rm = TRUE))
# Sabotage3
dat <- dat %>%
rowwise() %>%
mutate(actual.sab3 = sum(Sab3b_1, Sab3b_2, Sab3b_3, Sab3b_4, Sab3b_5, na.rm = TRUE))
# NON-AGENCY CONDITION - total deserve behaviors ## ==================================================== ##
# Sabotage1
dat <- dat %>%
rowwise() %>%
mutate(deserve.sab1.NA = sum(Sab1NA_1, Sab1NA_2, Sab1NA_3, Sab1NA_4, Sab1NA_5, na.rm = TRUE))
# Sabotage2
dat <- dat %>%
rowwise() %>%
mutate(deserve.sab2.NA = sum(Sab2NA_1, Sab2NA_2, Sab2NA_3, Sab2NA_4, Sab2NA_5, na.rm = TRUE))
# Sabotage3
dat <- dat %>%
rowwise() %>%
mutate(deserve.sab3.nA = sum(Sab3NA_1, Sab3NA_2, Sab3NA_3, Sab3NA_4, Sab3NA_5, na.rm = TRUE))
# NON-AGENCY CONDITION - total actual behaviors ## ==================================================== ##
# Sabotage1
dat <- dat %>%
rowwise() %>%
mutate(actual.sab1.NA = sum(Sab1NAb_1, Sab1NAb_2, Sab1NAb_3, Sab1NAb_4, Sab1NAb_5, na.rm = TRUE))
# Sabotage2
dat <- dat %>%
rowwise() %>%
mutate(actual.sab2.NA = sum(Sab2NAb_1, Sab2NAb_2, Sab2NAb_3, Sab2NAb_4, Sab2NAb_5, na.rm = TRUE))
# Sabotage3
dat <- dat %>%
rowwise() %>%
mutate(actual.sab3.NA = sum(Sab3NAb_1, Sab3NAb_2, Sab3NAb_3, Sab3NAb_4, Sab3NAb_5, na.rm = TRUE))
colnames(dat) #12 total new columns
# Add condition column. Retain totals
#Create new column for each condition
dat <- mutate(dat, condition = ifelse(is.na(Agency2),2,1)) #Agency2 is condition 1, NonA2 is condition 2
#remove Agency2 and NonA2 columns and select total columns
colnames(dat)
dat_1 <- select(dat, 1, 67:79)
dat_2 <- relocate(dat_1, condition, .after = ResponseId)
colnames(dat_2)
head(dat_2)
# Split then recombine Data Frame into one long ## ================= ##
cond1 <- dat_2 %>% #this is it chief
filter(condition==1) %>%
select(1:8)
cond2 <- dat_2 %>%
filter(condition==2) %>%
select(1,2,9:14)
names(cond2)[3] <- "deserve.sab1"
names(cond2)[4] <- "deserve.sab2"
names(cond2)[5] <- "deserve.sab3"
names(cond2)[6] <- "actual.sab1"
names(cond2)[7] <- "actual.sab2"
names(cond2)[8] <- "actual.sab3"
colnames(cond1)
colnames(cond2)
data_combined <- rbind(cond1, cond2) #the frame we are pivoting long
# Separate and Gather to make agendata_comb_grouped ## ================= ##
colnames(data_combined)
data_comb_long <- gather(data_combined, Key, Behaviors, 3:8) #gather is basically pivot_long. Gathers common attributes into Key (names) and Behavior (values) columns
dat_comb_sep <- separate(data_comb_long, Key, c("Kind", "Sabotage")) # splits Key into kind and sabotage
std <- function(x) sd(x)/sqrt(length(x))
agendata_comb_grouped <- dat_comb_sep %>% # Grouped by mean. More useful.
group_by(condition, Kind, Sabotage) %>%
summarize(Mean = mean(Behaviors),
SE = std(Behaviors))
# Link used to find gather function: https://uc-r.github.io/tidyr
